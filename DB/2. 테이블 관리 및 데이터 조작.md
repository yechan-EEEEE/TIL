# **SSAFY DB SQL 02: 테이블 관리 및 데이터 조작 (Managing Tables & Data)**

이 문서는 관계형 데이터베이스에서 테이블을 정의하고, 데이터를 조작하며, 여러 테이블을 결합하는 SQL 명령어(DDL, DML, JOIN)에 대한 내용을 정리합니다.

## **1. 테이블 생성 (CREATE TABLE)**

테이블을 정의하고 생성하는 DDL(Data Definition Language) 명령어입니다.

### **기본 문법**

```
CREATE TABLE table_name (  
    column_name1 data_type [Constraints],  
    column_name2 data_type [Constraints],  
    ...  
);
```

### **주요 제약 조건 (Constraints)**

테이블의 필드(열)에 적용되어 데이터의 정확성과 일관성을 유지하게 합니다.

| 제약 조건 | 설명 | 예시 |
| :---- | :---- | :---- |
| **PRIMARY KEY (PK)** | 테이블의 각 행을 고유하게 식별하는 키. NOT NULL과 UNIQUE 속성을 모두 가집니다. | id INTEGER PRIMARY KEY |
| **NOT NULL** | 해당 필드에 NULL 값이 저장되는 것을 허용하지 않습니다. | title VARCHAR(100) NOT NULL |
| **UNIQUE** | 해당 필드의 모든 값이 유일해야 합니다. NULL은 여러 개 허용됩니다. | email VARCHAR(50) UNIQUE |
| **DEFAULT** | 값이 명시되지 않을 경우 자동으로 삽입될 기본값을 지정합니다. | status VARCHAR(10) DEFAULT 'Pending' |
| **CHECK** | 특정 조건을 만족하는 값만 저장되도록 제한합니다. | age INTEGER CHECK (age >= 18) |
| **AUTOINCREMENT** | 레코드가 삽입될 때마다 고유한 번호를 자동으로 1씩 증가시키며 생성합니다. (SQLite, MySQL 등) | id INTEGER PRIMARY KEY AUTOINCREMENT |
| **FOREIGN KEY (FK)** | 다른 테이블의 기본 키(PK)를 참조하여 테이블 간의 관계를 설정합니다. 데이터 무결성(Integrity)을 유지하는 핵심 요소입니다. | user_id INTEGER REFERENCES users(id) |

**예시: articles 테이블 생성**

```
CREATE TABLE articles (  
    id INTEGER PRIMARY KEY AUTOINCREMENT,  
    title VARCHAR(100) NOT NULL,  
    content VARCHAR(200) NOT NULL,  
    createdAt DATE NOT NULL  
);
```

## **2. 테이블 구조 변경 및 삭제 (ALTER & DROP)**

테이블의 구조를 수정하거나 테이블 자체를 삭제하는 DDL 명령어입니다.

### **1. 필드 추가 (ADD COLUMN)**

기존 테이블에 새로운 열을 추가합니다.

```
ALTER TABLE table_name  
ADD COLUMN column_definition;

-- 예시: Age 필드(INTEGER)를 추가  
ALTER TABLE examples  
ADD COLUMN Age INTEGER;
```

* **주의:** 추가된 필드에 NOT NULL 제약 조건을 걸 경우, 기본값(DEFAULT value)을 지정해야 기존 레코드에서 발생하는 NULL 오류를 방지할 수 있습니다.

### **2. 필드 이름 변경 (RENAME COLUMN)**

열의 이름을 변경합니다.
```
ALTER TABLE table_name  
RENAME COLUMN old_column_name TO new_column_name;

-- 예시: Address 필드를 PostCode로 변경  
ALTER TABLE examples  
RENAME COLUMN Address TO PostCode;
```

### **3. 필드 삭제 (DROP COLUMN)**

테이블에서 특정 열을 제거합니다.
```
ALTER TABLE table_name  
DROP COLUMN column_name;

-- 예시: PostCode 필드를 삭제  
ALTER TABLE examples  
DROP COLUMN PostCode;
```

### **4. 테이블 이름 변경 (RENAME TO)**

테이블의 이름을 변경합니다.
```
ALTER TABLE old_table_name  
RENAME TO new_table_name;
```

### **5. 테이블 삭제 (DROP TABLE)**

테이블 자체와 테이블에 저장된 모든 데이터를 영구적으로 삭제합니다.
```
DROP TABLE table_name;
```

## **3. 데이터 조작 (DML)**

테이블 내의 데이터를 조작(삽입, 수정, 삭제)하는 DML(Data Manipulation Language) 명령어입니다.

### **1. 데이터 삽입 (INSERT)**

테이블에 새로운 레코드(행)를 추가합니다.
```
INSERT INTO table_name (column1, column2, ...)  
VALUES (value1, value2, ...);

-- 예시:  
INSERT INTO articles (title, content, createdAt)  
VALUES ('hello', 'world', '2000-01-01');
```

* **활용 2 (다중 삽입):** 여러 레코드를 한 번에 삽입할 수 있습니다.
```
INSERT INTO articles (title, content, createdAt)  
VALUES   
    ('title1', 'content1', '1900-01-01'),  
    ('title2', 'content2', '1800-01-01'),  
    ('title3', 'content3', '1700-01-01');
```

### **2. 데이터 수정 (UPDATE)**

기존 레코드의 값을 수정합니다. **WHERE 절을 사용하지 않으면 테이블의 모든 레코드가 수정됩니다.**
```
UPDATE table_name  
SET column1 = value1, column2 = value2, ...  
WHERE condition;

-- 예시: id가 1인 레코드의 title과 content를 변경  
UPDATE articles  
SET title = 'update Title', content = 'update Content'  
WHERE id = 1;
```

### **3. 데이터 삭제 (DELETE)**

기존 레코드를 삭제합니다. **WHERE 절을 사용하지 않으면 테이블의 모든 레코드가 삭제됩니다.**
```
DELETE FROM table_name  
WHERE condition;

-- 예시: id가 2인 레코드를 삭제  
DELETE FROM articles  
WHERE id = 2;
```

## **4. 테이블 조인 (JOIN)**

두 개 이상의 테이블을 연결하여 데이터를 조회하는 기능입니다. 테이블을 분리하여 데이터의 일관성 및 관리의 용이성을 높이고, 필요할 때 JOIN을 통해 통합된 데이터를 얻습니다.

### **JOIN의 필요성 (TIP)**

* 데이터를 분리하여 관리하고(예: 사용자 정보 테이블, 게시글 테이블), 중복을 줄일 수 있습니다.  
* 사용자 정보(이름, 역할)와 게시글 정보(제목, 내용)를 함께 조회하고 싶을 때 사용합니다.

### **1. INNER JOIN (내부 조인)**

두 테이블에서 **조인 조건(Foreign Key)이 일치하는 레코드**만 반환합니다.
```
SELECT T1.column, T2.column  
FROM Table1 AS T1  
INNER JOIN Table2 AS T2  
ON T1.fk = T2.pk  
WHERE condition;

-- 예시: '하석주'가 작성한 게시글의 제목과 작성자 이름을 함께 조회  
SELECT A.title, U.name  
FROM articles AS A  
INNER JOIN users AS U  
ON A.userId = U.id  
WHERE U.name = '하석주';
```

### **2. LEFT JOIN (LEFT OUTER JOIN, 왼쪽 외부 조인)**

왼쪽(FROM 절에 먼저 명시된) 테이블의 모든 레코드를 포함하며, 오른쪽 테이블에서는 조인 조건이 일치하는 레코드만 포함합니다.  
일치하는 레코드가 없는 경우, 오른쪽 테이블의 열은 NULL로 표시됩니다.
```
SELECT T1.column, T2.column  
FROM Table1 AS T1  
LEFT JOIN Table2 AS T2  
ON T1.fk = T2.pk;
```

**TIP: LEFT JOIN 활용**

* 왼쪽 테이블의 모든 데이터를 기준으로 보고 싶을 때 유용합니다.  
* 어떤 데이터가 연결 테이블에 누락되었는지 확인할 때 사용됩니다. (예: WHERE T2.column IS NULL)

## **5. 추가 참고 사항**

### **1. 타입 선호도 (Type Affinity)**

SQLite와 같은 일부 RDBMS에서 사용되는 개념으로, 데이터 타입이 엄격하게 지켜지지 않을 수 있음을 의미합니다.

* 예를 들어, 필드를 INTEGER로 선언했더라도 문자열이 삽입될 수 있으며, 시스템이 데이터를 가장 적합한 타입으로 변환하려고 시도합니다.

### **2. NOT NULL 제약 조건**

* **반드시 NOT NULL 제약을 해야 하는가?** 프로그램에서 NULL을 허용하지 않을 경우 대부분의 필드에 NOT NULL 제약을 사용하는 것이 좋습니다.  
* **"값이 없다"는 표현:** 데이터베이스에서는 0이나 빈 문자열('')을 사용하는 것보다, 명확하게 **NULL 값**을 사용하여 "값이 존재하지 않음"을 나타내는 것을 권장합니다.

## **6. 핵심 키워드 정리 (복습)**

| 키워드 | 구분 | 설명 | 예시 |
| :---- | :---- | :---- | :---- |
| **CREATE TABLE** | DDL | 새로운 테이블을 정의하고 생성 | CREATE TABLE users (...) |
| **INSERT** | DML | 테이블에 새로운 데이터를 삽입 | INSERT INTO users (name) VALUES ('Jane'); |
| **SELECT** | DQL | 테이블에서 데이터를 조회 | SELECT * FROM users; |
| **UPDATE** | DML | 기존 데이터를 수정 | UPDATE users SET name = 'Kim' WHERE id = 1; |
| **DELETE** | DML | 데이터를 삭제 | DELETE FROM users WHERE id = 1; |
| **ALTER TABLE** | DDL | 테이블의 구조를 변경 (열 추가/삭제 등) | ALTER TABLE users ADD COLUMN age INTEGER; |
| **DROP TABLE** | DDL | 테이블 자체를 삭제 | DROP TABLE users; |
| **PRIMARY KEY** | 제약 조건 | 행을 고유하게 식별하는 키 | id INTEGER PRIMARY KEY |
| **JOIN** | DQL | 두 개 이상의 테이블을 결합하여 조회 | INNER JOIN articles ON ... |

