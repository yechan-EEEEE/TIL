# Layer2(롤업) · 브릿지 · 확장성(Scalability) 개념 정리

> 목적: 블록체인에서 가장 현실적인 문제인 **확장성(속도/비용)**을 해결하기 위해 등장한  
> **Layer2(특히 Rollup)**, 그리고 체인 간 이동을 위한 **Bridge** 개념을 구조적으로 이해하기 위한 노트

---

## 1) 확장성(Scalability) 문제란?

블록체인은 “모든 노드가 동일한 거래를 검증하고 저장”한다.

이 방식은 보안/신뢰성은 강하지만, 아래 문제가 발생한다.

- 거래 처리 속도(TPS)가 낮다
- 수수료가 비싸다
- 네트워크가 혼잡하면 사용성이 급격히 나빠진다

---

## 2) 블록체인의 확장성 3대 트릴레마

블록체인에서 자주 나오는 개념:

> **확장성(Scalability)**, **보안(Security)**, **탈중앙화(Decentralization)**  
> 이 3개를 동시에 최대화하기 어렵다.

즉, 성능을 올리면 중앙화 위험이 커지거나,  
탈중앙화를 유지하면 TPS가 떨어지는 식의 trade-off가 존재한다.

---

## 3) 이더리움에서 확장성이 특히 중요한 이유

이더리움은 “스마트 컨트랙트 실행”을 지원한다.

즉, 단순 송금보다 훨씬 복잡한 연산이 많아지고,
네트워크 사용량이 폭증한다.

결과:
- 가스비 급등
- 트랜잭션 처리 지연
- DeFi/NFT 사용성이 떨어짐

→ 그래서 Layer2가 사실상 필수 인프라가 되었다.

---

## 4) 확장성 해결 접근 2가지: 온체인 vs 오프체인

### 4.1 온체인 확장(On-chain scaling)
L1 자체를 빠르게 만드는 방식.

예:
- 블록 크기 증가
- 블록 생성 속도 증가
- 샤딩(Sharding)

단점:
- 노드 저장/검증 부담 증가 → 중앙화 위험
- 네트워크 전체 구조를 크게 바꿔야 함

---

### 4.2 오프체인 확장(Off-chain scaling)
L1은 “최종 정산” 역할만 하고,  
실제 거래 처리는 L2에서 수행하는 방식.

대표가 **Layer2 + Rollup**이다.

---

## 5) Layer1 vs Layer2

### 5.1 Layer1(L1)
- 메인 블록체인
- 예: Ethereum Mainnet

특징:
- 가장 강한 보안성
- 가장 비싼 수수료
- 가장 느린 처리 속도

---

### 5.2 Layer2(L2)
- L1 위에 구축된 확장 네트워크
- 거래를 묶어서 처리한 뒤, 결과만 L1에 기록

목표:
- TPS 증가
- 수수료 절감
- 사용자 경험 개선

---

## 6) 롤업(Rollup)이란?

Rollup은 이더리움 L2의 대표 방식이다.

핵심 아이디어:

> **거래를 L2에서 처리하고, 그 결과를 L1에 “압축해서 제출”한다.**

즉,
- L2에서 수천 개 거래를 처리
- 이를 하나의 묶음(batch)으로 만들고
- L1에 “요약 데이터 + 증명”만 올린다

---

## 7) 롤업 구조(아키텍처)

롤업 시스템은 보통 다음 요소로 구성된다.

### 7.1 Sequencer(시퀀서)
- L2에서 거래를 모으고 순서를 정하는 역할
- 사실상 “L2의 블록 생산자”

특징:
- 대부분 현재는 중앙화된 시퀀서가 많음
- 속도는 빠르지만, 중앙화 논쟁이 존재

---

### 7.2 Rollup Node
- L2의 상태를 유지하고 실행하는 노드
- 트랜잭션 실행 및 상태 업데이트 수행

---

### 7.3 L1 Rollup Contract
- L2 결과를 받아 L1에 기록하는 컨트랙트
- 증명 검증(특히 ZK 롤업)
- 출금(withdraw) 처리

---

### 7.4 Data Availability(DA, 데이터 가용성)
“L2에서 처리된 거래 데이터가 누구나 접근 가능한가?”

- 데이터가 공개되지 않으면 검증이 불가능해짐
- 롤업의 신뢰성 핵심

---

## 8) Optimistic Rollup(옵티미스틱 롤업)

### 8.1 핵심 아이디어
> “일단 맞다고 가정(Optimistic)하고 제출한다.”

- 증명을 즉시 제출하지 않음
- 누군가가 문제를 발견하면 “사기 증명(Fraud Proof)”로 반박

---

### 8.2 장점
- 구현이 상대적으로 단순
- EVM 호환성이 좋음
- 생태계가 큼

---

### 8.3 단점
- 출금이 느림 (challenge period 필요)
- 사기 증명 시스템이 제대로 작동해야 함

---

### 8.4 대표 예시
- Optimism
- Arbitrum

---

## 9) ZK Rollup(영지식 롤업)

### 9.1 핵심 아이디어
> “결과가 맞다는 수학적 증명(ZK Proof)을 제출한다.”

- L2 거래를 처리한 뒤
- 그 결과가 올바르다는 증명을 생성
- L1에서 증명을 검증

---

### 9.2 장점
- 빠른 확정성
- 출금이 빠름
- 강한 보안성(수학적 증명)

---

### 9.3 단점
- 구현이 매우 복잡
- 증명 생성 비용이 큼
- 완전한 EVM 호환이 어렵거나 제한적일 수 있음

---

### 9.4 대표 예시
- zkSync
- Starknet
- Scroll

---

## 10) 롤업이 확장성을 높이는 이유

### 10.1 L1의 병목을 줄인다
L1은 모든 트랜잭션을 실행하지 않고,
**데이터 저장 + 최종 정산만 수행**한다.

---

### 10.2 거래를 묶어 비용을 분산한다
- L2에서 1000건 처리
- L1에는 1건의 batch만 기록

→ 수수료가 크게 감소한다.

---

## 11) 브릿지(Bridge)란?

브릿지는 서로 다른 체인(또는 L1↔L2) 사이에서  
자산을 이동시키는 구조다.

예:
- Ethereum → Arbitrum으로 ETH 이동
- Polygon → Ethereum으로 토큰 이동

---

## 12) 브릿지의 기본 동작 원리

브릿지는 보통 다음 방식으로 작동한다.

### 12.1 Lock & Mint 방식
1. A 체인에서 토큰을 Lock(잠금)
2. B 체인에서 동일 가치의 Wrapped Token을 Mint(발행)

출금 시:
1. B 체인 Wrapped Token을 Burn(소각)
2. A 체인에서 원본 토큰 Unlock(해제)

---

### 12.2 Burn & Mint 방식
- 체인 간 이동을 “소각 + 발행”으로 처리

---

## 13) Wrapped Token(래핑 토큰)이란?
브릿지를 이용하면 원래 체인의 토큰을 그대로 옮길 수 없다.

그래서 다른 체인에서는
- “원본 토큰을 대표하는 토큰”을 발행한다.

예:
- WETH
- WBTC

---

## 14) 브릿지가 위험한 이유(중요)

브릿지는 블록체인에서 가장 해킹이 많이 발생하는 영역이다.

왜냐하면:
- 브릿지는 “큰 돈이 잠긴 금고” 역할을 한다
- 공격자가 성공하면 대규모 자산 탈취 가능

---

### 14.1 대표적인 브릿지 취약점
- 멀티시그 키 탈취
- 검증 로직 버그
- 메시지 검증 실패
- 오라클/릴레이어 조작

---

### 14.2 실무에서 브릿지가 해킹 타겟 1순위인 이유
- 공격 성공 시 피해 규모가 매우 큼
- 복잡한 구조 때문에 취약점이 생기기 쉬움
- 여러 체인/컨트랙트가 얽혀있음

---

## 15) 확장성 관련 추가 개념

### 15.1 샤딩(Sharding)
네트워크를 여러 조각(shard)으로 나눠
병렬 처리하는 방식.

- 이더리움 로드맵에서 중요한 키워드
- 최근에는 “데이터 샤딩(DA)” 중심으로 발전하는 방향

---

### 15.2 데이터 가용성(Data Availability, DA)
롤업에서 매우 중요한 개념.

- 거래 데이터가 공개되어야 누구나 검증 가능
- 데이터가 숨겨지면 롤업은 신뢰를 잃는다

DA 해결 방식:
- 이더리움 calldata
- DA 전용 네트워크(Celestia 등)
- Danksharding 방향

---

### 15.3 모듈러 블록체인(Modular Blockchain)
최근 블록체인 설계 트렌드.

기존(Monolithic):
- 실행 + 합의 + 데이터 + 정산이 한 체인에 모두 포함

모듈러(Modular):
- 실행(Execution) / 합의(Consensus) / DA / 정산(Settlement)을 분리
- 각 기능을 전문화된 체인이 담당

---

## 16) 프로젝트 관점에서 핵심 포인트

### 16.1 L2를 쓰는 이유는 “수수료 + 속도”
- L1만 쓰면 너무 비싸고 느림
- 실사용 서비스는 L2가 훨씬 현실적

---

### 16.2 하지만 L2도 완전 탈중앙은 아니다
- 많은 L2는 시퀀서가 중앙화돼 있음
- 탈중앙화는 단계적으로 진행 중

---

### 16.3 브릿지는 “편의 기능”이 아니라 “보안 위험 영역”
- 브릿지 설계는 프로젝트의 보안 수준을 결정할 수 있음
- 가능하면 검증된 브릿지/공식 브릿지 사용

---

## 17) 한 줄 요약

- 확장성 문제는 블록체인의 구조적 한계에서 출발한다.  
- Layer2(롤업)는 거래를 L2에서 처리하고 결과만 L1에 제출해 해결한다.  
- Optimistic은 “일단 믿고” + Fraud Proof, ZK는 “수학적 증명” 기반이다.  
- 브릿지는 체인 간 자산 이동을 가능하게 하지만, 해킹 위험이 가장 큰 영역이다.
